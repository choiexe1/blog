---
title: 
tags:
  - java
  - spring
  - programming
  - proxy
  - bean-post-processor
publish: true
date: 2025-01-03
---
# 빈 후처리기 Bean Post Processor
## 배경
- 프록시 객체를 스프링 빈으로 등록하기 위해서는 구성 정보 클래스를 조작해야 하는데, 이 과정이 매우 귀찮음
- 컴포넌트 스캔 방식의 빈 등록 시에 프록시 적용 불가
- 이 문제를 해결하려면 **빈 후처리기(Bean Post Processor)**를 사용
- 스프링이 객체를 빈 저장소에 등록하기 직전에 조작을 원할 때 사용한다.

## 빈 후처리기를 통한 스프링 빈 등록 과정

![[bean-post-processor-1.png]]
- **생성**: 스프링 빈 대상이 되는 객체를 생성한다.
- **전달**: 생성된 객체를 빈 저장소에 등록하기 직전에 빈 후처리기에 전달한다.
- **후 처리 작업**: 빈 후처리기는 전달된 스프링 빈 객체를 조작하거나 다른 객체로 바꿔치기 할 수 있다.
- **등록**: 빈 후처리기는 빈을 반환하고 해당 빈이 스프링 빈 저장소에 등록된다.

## 후킹 Hooking
- 운영 체제나 응용 소프트웨어등 각종 컴퓨터 프로그램에서 소프트웨어의 구성 요소 간의 함수 호출, 메시지, 이벤트 등을 중간에서 바꾸거나 가로채는 방법이나 기술을 의미
- **빈 후처리기**는 스프링 빈 저장소에 빈을 등록하기 직전에 **후킹**을 통해서 객체를 바꿔치기 하거나 객체를 조작한다.

## 예제

#### 일반적인 스프링 빈 등록 과정
빈 후처리기 학습 전에 일반적인 스프링 빈 등록 과정을 살펴본다.

```java
@Test  
void basicConfig() {  
    ApplicationContext context = new AnnotationConfigApplicationContext(BasicConfig.class);  
    A a = (A) context.getBean("beanA");  
    a.helloA();  
  
    Assertions.assertThatThrownBy(() -> {  
        context.getBean("beanB");  
    }).isInstanceOf(NoSuchBeanDefinitionException.class);  
}  
  
@Slf4j  
static class A {  
    public void helloA() {  
        log.info("Hello A");  
    }  
}  
  
@Slf4j  
static class B {  
    public void helloB() {  
        log.info("Hello B");  
    }  
}  
  
@Configuration  
static class BasicConfig {  
    @Bean(name = "beanA")  
    public A a() {  
        return new A();  
    }  
}
```
- `B` 클래스는 스프링 빈으로 등록하지 않았기 때문에 `basicConfig()` 테스트가 통과한다.

#### 빈 후처리기 후킹
이번 예제는 빈 후처리기로 스프링 빈 등록 직전에  `A` 객체를 후킹해서 `B` 객체로 바꿔치기한다. 빈 후처리기를 사용하려면 `BeanPost`


---
References: 김영한의 스프링 핵심 원리 - 고급편

Links to this page: 