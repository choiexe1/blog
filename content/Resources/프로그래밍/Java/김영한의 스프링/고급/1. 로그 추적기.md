---
title: 
tags:
  - java
  - programming
  - spring
publish: true
date: 2024-12-29
---
## 예제 프로젝트 만들기 - V0
- Gradle - Groovy
- Java 17
- Spring Boot 3.4.1
	- Spring Web
	- Lombok

스프링에 대한 핵심 원리를 파악해보기 위해 먼저 예제 프로젝트로 상품을 주문하는 프로세스로 가정하고, 일반적인 웹 어플리케이션에서 `Controller -> Service -> Repository`로 이어지는 흐름을 최대한 단순하게 만들어본다.

```java title="OrderRepositoryV0.java"
@Repository  
@RequiredArgsConstructor  
public class OrderRepositoryV0 {  
    public void save(String itemId) {  
        if (itemId.equals("ex")) {  
            throw new IllegalStateException("예외 발생");  
        }  
          
        sleep(1000);  
    }  
  
    private void sleep(int ms) {  
        try {  
            Thread.sleep(ms);  
        } catch (InterruptedException e) {  
            e.printStackTrace();  
        }  
    }  
}
```

```java title="OrderServiceV0.java"
@Service  
@RequiredArgsConstructor  
public class OrderServiceV0 {  
    private final OrderRepositoryV0 orderRepository;  
  
    public void orderItem(String itemId) {  
        orderRepository.save(itemId);  
    }  
}
```

```java title="OrderControllerV0.java"
@RestController  
@RequiredArgsConstructor  
public class OrderControllerV0 {  
    private final OrderServiceV0 orderService;  
  
    @GetMapping("/v0/request")  
    public String request(String itemId) {  
        orderService.orderItem(itemId);  
        return "ok";  
    }  
}
```

테스트 삼아 요청을 보내보면 정상적으로 잘 동작한다.

## 로그 추적기 - 요구사항 분석

다음의 상황을 가정하고 로그 추적기를 구현해본다.
```
새로운 회사에 입사했는데, 수 년간 운영중인 거대한 프로젝트에 투입되었다. 
전체 소스 코드는 수 십만 라인이고 클래스 수도 수 백개 이상이다. 처음 맡겨진 요구사항은 로그 추적기를 만드는 것이다.

어플리케이션이 점점 커지면서 점점 모니터링과 운영이 중요해지는 단계이다. 
특히 최근 자주 병목이 발생하고 있다. 어떤 부분에서 병목이 발생하는지, 그리고 어떤 부분에서 예외가 발생하는지를 로그를 통해 확인하는 것이 점점 중요해지고 있다.

기존에는 개발자가 문제가 발생한 다음에 관련 부분을 어렵게 찾아서 로그를 하나하나 직접 만들어서 남겼다. 로그를 미리 남겨둔다면 이런 부분을 손쉽게 찾을 수 있을 것이다. 이 부분을 개선하고 자동화 하는 것이 미션이다.
```

---
References: 김영한의 스프링 핵심 원리 - 고급편

Links to this page: 