---
title: 
tags:
  - java
  - programming
  - spring
  - security
publish: true
date: 2024-12-06
---
## 스프링 시큐리티
스프링 시큐리티는 사용자 정의 가능한 인증 및 접근 제어 프레임워크이다. 이는 Spring 기반 애플리케이션 보안을 위한 사실상의 표준이다. 

스프링 시큐리티는 Java 애플리케이션에 인증과 권한 부여를 모두 제공하는 데 중점을 둔 프레임워크이다.

스프링 시큐리티를 사용하면 웹 어플리케이션 전반, 인증 및 접근 제어 기능을 간단하게 구현할 수 있다.

## 안전하지 않은 웹 어플리케이션 구현
먼저 간단한 웹 어플리케이션을 구현하고, 점진적으로 스프링 시큐리티를 적용해본다.

이 웹 어플리케이션은 스프링 MVC를 기반으로 타임리프 템플릿 엔진을 통해 웹 페이지를 렌더링 한다. 따라서 다음과 같이 간단한 구조의 `HTML`을 작성한다.

```html title="home.html"
<!DOCTYPE html>  
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">  
<head>  
    <title>Spring Security Example</title>  
</head>  
<body>  
    <h1>Welcome!</h1>  
    <p>Click <a th:href="@{/hello}">here</a> to see a greeting.</p>  
</body>  
</html>
```

```html title="hello.html"
<!DOCTYPE html>  
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">  
<head>  
    <title>Hello World!</title>  
</head>  
<body>  
    <h1>Hello world!</h1>  
</body>  
</html>
```

이제 이 템플릿을 렌더링하는 컨트롤러를 구현해야 한다. 가이드에서는 다음과 같이 `WebMvcConfigurer`를 통해 경로와 뷰를 지정한다.

```java
Configuration  
public class WebConfig implements WebMvcConfigurer {  
    @Override  
    public void addViewControllers(ViewControllerRegistry registry) {  
        registry.addViewController("/home").setViewName("home");  
        registry.addViewController("/").setViewName("home");  
        registry.addViewController("/hello").setViewName("hello");  
        registry.addViewController("/login").setViewName("login");  
    }  
}
```

로그인 페이지는 이 후에 만든다. 이 시점에서 어플리케이션은 보안되지 않은 상태이므로 어떤 페이지에 누구든 쉽게 접근할 수 있다.

## 스프링 시큐리티 적용
개발자의 의도는 권한이 없는 사용자가 `/hello`에 인사말 페이지를 보지 못하도록 막으려고 한다.

그런데 현 시점의 어플리케이션은 방문자가 홈 페이지의 링크를 클릭하면 막을 수 있는 방법이 없다. 방문자가 해당 페이지를 보기 전에 강제로 로그인 하도록 하는 과정을 추가해야 한다.

가장 먼저 할 일은 의존성을 추가하는 것이다.

하나는 어플리케이션 용, 하나는 `Thymeleaf` 및 `Spring Security` 통합용, 하나는 테스트용이다.

```
implementation 'org.springframework.boot:spring-boot-starter-security' 
implementation 'org.thymeleaf.extras:thymeleaf-extras-springsecurity6:3.1.2.RELEASE' 
testImplementation 'org.springframework.security:spring-security-test'
```

다음은 시큐리티 구성 정보 클래스를 작성하는 것이다. 다음과 같이 작성한다.

```java
@Configuration  
@EnableWebSecurity  
public class WebSecurityConfig {  
  
    @Bean  
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {  
        http  
                .authorizeHttpRequests((requests) -> requests  
                        .requestMatchers("/", "/home").permitAll()  
                        .anyRequest().authenticated()  
                )  
                .formLogin((form) -> form  
                        .loginPage("/login")  
                        .permitAll()  
                )  
                .logout((logout) -> logout.permitAll());  
  
        return http.build();  
    }  
  
    @Bean  
    public UserDetailsService userDetailsService() {  
        UserDetails user =  
                User.withDefaultPasswordEncoder()  
                        .username("user")  
                        .password("password")  
                        .roles("USER")  
                        .build();  
  
        return new InMemoryUserDetailsManager(user);  
    }  
}
```

---
References: [스프링 공식문서 - 스프링 시큐리티 가이드](https://spring.io/guides/gs/securing-web)

Links to this page: 