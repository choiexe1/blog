---
title: 
tags:
  - java
  - programming
  - spring
  - orm
  - jpa
  - database
publish: true
date: 2024-12-16
---
## JPA 소개
스프링과 `JPA`는 자바 엔터프라이즈(기업) 시장의 주력 기술이다. 스프링이 `DI`를 포함한 어플리케이션 전반의 다양한 기능을 제공한다면, `JPA`는 `ORM` 데이터 접근 기술을 제공한다.

스프링 + 데이터 접근 기술의 조합을 구글 트렌드로 비교했을 때
- 글로벌에서는 스프링 + `JPA` 조합을 80% 이상 사용한다.
- 국내에서도 스프링 + `JPA` 조합을 50% 정도 사용하고, 2015년 부터 점점 그 추세가 증가하고 있다.

`JPA`는 스프링만큼이나 방대하고, 학습해야할 분량도 많다. 하지만 한번 배워두면 데이터 접근 기술에서 매우 큰 생산성 향상을 얻을 수 있다. 대표적으로 `JdbcTemplate`이나 `MyBatis`같은 `SQL Mapper` 기술은 `SQL`을 개발자가 직접 작성해야 하지만, `JPA`를 사용하면 SQL도 `JPA`가 대신 작성하고 처리해준다.

실무에서는 `JPA`를 더욱 편리하게 사용하기 위해 `Spring Data JPA`와 `Querydsl`이라는 기술을 함께 사용한다. 중요한 것은 `JPA`다. `Spring Data JPA`, `Querydsl`은 `JPA`를 편리하게 사용하도록 도와주는 도구라 생각하면 된다.

이 강의에서는 모든 내용을 다루지 않고, `JPA`와 `Spring Data JPA`, 그리고 `Querydsl`로 이어지는 전체 그림을 볼 것이다. 그리고 이 기술들을 우리 어플리케이션에 적용하면서 자연스럽게 왜 사용해야 되는지, 어떤 장점이 있는지 이해할 수 있게 된다.

#### JPA
- Java Persistence API
- 자바 진영의 ORM 표준 인터페이스

**트랜잭션을 지원하는 쓰기 지연 기능**

트랜잭션을 커밋할 때 까지 INSERT SQL을 모은다. 커밋 시 `JDBC BATCH SQL` 기능을 사용해서 한번에 SQL을 전송한다. 따라서 네트워크 통신 횟수를 줄이고, 성능을 개선한다.

**지연 로딩과 즉시 로딩**
- 지연 로딩: 객체가 실제 사용될 때 로딩
- 즉시 로딩: JOIN SQL로 한번에 연관된 객체까지 미리 조회

지연 로딩은 객체 그래프를 탐색할 때, 객체의 연관 관계에 있는 객체의 속성에 접근하는 시점에 데이터를 불러오는 방식이다. 지연 로딩의 단점으로는 `team`의 속성에 접근하려면 쿼리가 두 번 실행된다는 단점이 있다. 

다음의 그림을 참고하자.

![[jpa-1.png]]

특정 객체를 가져올 때 어플리케이션 내에서 일반적으로 멤버와 팀 데이터를 함께 가져와서 사용해야 한다면 즉시 로딩을 통해 최초의 쿼리 한번으로 데이터를 가져올 수 있다. 말 그대로 JOIN을 걸어서 가져오는 것이다. 다음의 그림을 참고하자.

![[jpa-2.png]]

- 지연 로딩은 쿼리가 두 번 실행된다. 쉽게 말해, 데이터베이스 서버와 두 번의 통신이 발생한다. 이는 자원 낭비로 이어지는 문제가 발생한다.
- 개발 할 때는 지연 로딩으로 개발하다가, 최적화가 필요한 어느 지점에서는 즉시 로딩으로 변경하여 성능을 개선할 수 있다.

---
References: 김영한의 스프링 DB 2편

Links to this page: 