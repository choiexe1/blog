---
title: 
tags:
  - java
  - programming
  - spring
  - transaction
publish: true
date: 2024-12-26
---
## 스프링 트랜잭션
먼저 본격적인 기능 설명에 앞서서, 지금까지 학습한 스프링 트랜잭션을 간략히 복습한다.

#### 스프링 트랜잭션 추상화
[[5. 스프링과 문제 해결 - 트랜잭션#트랜잭션 추상화|트랜잭션 추상화]]에서 학습했다. 각 데이터 기술들은 트랜잭션을 처리하는 방식에 차이가 있다. 예를 들어 `JDBC`와 `JPA`는 트랜잭션을 사용하는 코드 자체가 다르다.

- `JDBC`는 `setAutoCommit(false)`를 통해 트랜잭션을 시작한다.
- `JPA`는 `getTransaction()`을 통해 트랜잭션 기능을 획득하고 `begin()`, `commit()`, `rollback()`, `close()` 등의 메서드를 이용해 트랜잭션을 다룬다.

따라서 `JDBC`를 사용하다가 `JPA`를 사용하게 되면 트랜잭션을 사용하는 코드도 모두 함께 변경해야한다. 스프링은 이런 문제를 해결하기 위해 트랜잭션을 추상화했다.
트랜잭션을 사용하는 입장에서는 스프링 트랜잭션 추상화를 통해 둘을 동일한 방식으로 사용하게 되는 것이다.

스프링은 `PlatformTransactionManager`라는 인터페이스를 통해 트랜잭션을 추상화한다.

![[transaction-10.png]]

- 스프링은 트랜잭션을 추상화해서 제공할 뿐만 아니라, 실무에서 주로 사용하는 데이터 접근 기술에 대한 트랜잭션 매니저의 구현체도 제공한다. 개발자는 필요한 구현체를 스프링 빈으로 등록하고 주입 받아서 사용하기만 하면 되는 것이다.
- 여기에 더해서 스프링 부트는 어떤 데이터 접근 기술을 사용하는지를 자동으로 인식(라이브러리 인식)해서 적절한 트랜잭션 매니저를 선택해서 스프링 빈으로 등록해준다. 따라서 트랜잭션 매니저를 선택하고 등록하는 과정마저 생략할 수 있다.
- 예를 들어 `JdbcTemplate`이나 `MyBatis`를 사용하면 `DataSourceTransactionManager(JdbcTransactionManager)`를 스프링 빈으로 등록하고, JPA를 사용하면 `JpaTransactionManager`를 스프링 빈으로 등록해준다.

#### 스프링 트랜잭션 사용 방식

**선언적 트랜잭션 관리**
- `@Transactional` 어노테이션 하나만으로 매우 편리하게 트랜잭션을 적용한다.

**프로그래밍 방식 트랜잭션 관리**
- 트랜잭션 매니저 또는 트랜잭션 템플릿등을 이용해서 트랜잭션 관련 코드를 직접 작성하는 것을 프로그래밍 방식의 트랜잭션 관리라 한다.
- 이렇게 되면 어플리케이션 코드가 트랜잭션이라는 기술과 강하게 결합된다.

#### 선언적 트랜잭션과 AOP
`@Transactional`을 통한 선언적 트랜잭션 관리 방식을 사용하게 되면 기본적으로 프록시 방식의 AOP가 적용된다. 이는 앞서 [[6. 트랜잭션 문제 해결 - 트랜잭션 AOP 이해#스프링이 제공하는 트랜잭션 AOP|트랜잭션 AOP 이해]]에서 학습했다.

## 트랜잭션 적용 확인 
`@Transactional`을 통해 선언적 트랜잭션을 사용하면, 단순히 어노테이션 하나로 트랜잭션을 적용할 수 있다. 그렇지만 AOP를 기반으로 트랜잭션이 동작하기 때문에 실제로 트랜잭션이 적용되고 있는지 확인하기가 어렵다.




---
References: 김영한의 스프링 DB 2편

Links to this page: [[5. 스프링과 문제 해결 - 트랜잭션]]