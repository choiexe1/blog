---
title: 
tags:
  - java
  - spring
  - thymeleaf
  - mvc
  - programming
publish: true
date: 2024-11-25
---
## 타임리프 스프링 통합
타임리프는 스프링 없이도 동작하지만, 스프링과 통합을 위한 다양한 기능을 편리하게 제공한다. 그리고 이런 부분은 스프링으로 백엔드를 개발하는 개발자 입장에서 타임리프를 선택하는 하나의 이유가 된다.

**스프링 통합으로 추가되는 기능들**
- 스프링의 SpringEL 문법 통합
- `${@myBean.doSomething()}`처럼 스프링 빈 호출 지원
- 편리한 폼 관리를 위한 추가 속성
	- `th:object` (기능 강화, 폼 커맨드 객체 선택)
	- `th:field`, `th:errors`, `th:errorclass`
- 폼 컴포넌트 기능
	- checkboxk, radio button, list 등을 편리하게 사용할 수 있는 기능 지원
- 스프링의 메세지, 국제화 기능의 편리한 통합
- 스프링의 검증, 오류 처리 통합
- 스프링의 변환 서비스 통합(ConversionService)

### 입력 폼 처리
타임리프가 제공하는 입력 폼 기능을 적용해서 기존 프로젝트의 폼 코드를 타임리프가 지원하는 기능을 사용해서 효율적으로 개선한다.

입력 폼 처리를 타임리프와 통합하여 사용하려면, 다음과 같이 먼저 수정이 필요한 **커맨드 객체**를 모델로 뷰에 전달해야 한다.

> 커맨드 객체는 폼과 관련된 객체를 의미한다.

```java
@GetMapping("/add")  
public String addForm(Model model) {  
    model.addAttribute("item", new Item());  
    return "form/addForm";  
}

@PostMapping("/add")  
public String addItem(@ModelAttribute Item item, RedirectAttributes redirectAttributes) {  
    Item savedItem = itemRepository.save(item);  
    redirectAttributes.addAttribute("itemId", savedItem.getId());  
    redirectAttributes.addAttribute("status", true);  
    return "redirect:/form/items/{itemId}";  
}
```

그리고 다음과 같은 문법을 통해서 마크업 한다.

```html
<form action="item.html" th:action th:object="${item}" method="post">  
    <div>        
	    <label for="itemName">상품명</label>  
        <input type="text" id="itemName" th:field="*{itemName}" class="form-control" placeholder="이름을 입력하세요">  
    </div>
	<div>
		<label for="price">가격</label>  
        <input type="text" id="price" class="form-control" th:field="*{price}" placeholder="가격을 입력하세요">  
    </div>
	<div>
		<label for="quantity">수량</label>  
        <input type="text" id="quantity" th:field="*{quantity}" class="form-control" placeholder="수량을 입력하세요">  
    </div>
```

우선 `form` 태그에 `th:object` 속성을 통해 전달 받은 커맨드 객체를 지정한다. 여기서 지정된 객체는 이 `form` 태그 내부에서 사용된다.

`th:field` 속성은 커맨드 객체의 속성을 폼의 필드로써 사용하도록 지정하는 것이다. 앞서 `th:object`로 `Item` 객체를 지정했기 때문에 `th:field`으로 해당 객체의 특정 필드를 지정할 수 있다.

첫 번째 상품명의 `th:field` 속성을 살펴보면 `*{itemName}`으로 지정되어 있다. 이는 **선택 변수 식**이라는 표현식인데, 앞서 `th:object`를 통해 지정한 커맨드 객체의 속성을 선택하는 것이다. 다음의 두 표현식은 동일하게 작동한다.

- `th:field="*{itemName}"`
- `th:field="${item.itemName}"`

또, `th:field`는 렌더링 시 해당 `input` 태그에 `id`, `name`, `value` 속성을 자동으로 만들어준다. 굉장히 편리한 기능이다.

타임리프의 입력 폼 처리 통합 기능은 객체 수정 시에 그 진가를 발휘한다.

```java
@GetMapping("/{itemId}/edit")  
public String editForm(@PathVariable Long itemId, Model model) {  
    Item item = itemRepository.findById(itemId);  
    model.addAttribute("item", item);  
    return "form/editForm";  
}

@PostMapping("/{itemId}/edit")  
public String edit(@PathVariable Long itemId, @ModelAttribute Item item) { 
    itemRepository.update(itemId, item);  
    return "redirect:/form/items/{itemId}";  
}
```

앞서 생성된 `Item` 객체를 수정하는 폼을 다루는 컨트롤러다. 

---
References: 김영한의 스프링 MVC 2편

Links to this page: 