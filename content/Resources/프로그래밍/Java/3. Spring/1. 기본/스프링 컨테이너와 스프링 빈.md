---
title: 
tags:
  - java
  - programming
  - spring
publish: true
date: 2024-11-16
---
## 스프링 컨테이너 생성
```java
ApplicationContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
```
- `ApplicationContext`를 스프링 컨테이너라 한다.
- `ApplicationContext`는 인터페이스다.
- 스프링 컨테이너는 XML을 기반으로 만들 수도 있고, 어노테이션 기반의 자바 설정 클래스로 만들 수 있다.
- 앞서 `AppConfig`을 사용했던 방식이 어노테이션 기반의 자바 설정 클래스로 스프링 컨테이너를 만든 것이다.
- `new AnnotationConfigApplicationContext(AppConfig.class)` 이 클래스는 `ApplicationContext`의 구현체이다.
- 이 코드는 자바 설정 클래스를 기반으로 스프링 컨테이너를 만든 것이다.

> [!tip] 참고
> 더 정확히는 스프링 컨테이너를 부를 때 `BeanFactory`와 `ApplicationContext`로 구분해서 이야기 한다. 이에 대해서는 추후에 따로 설명한다. 
> 
> `BeanFactory`를 직접 사용하는 경우는 거의 없으므로 일반적으로 `ApplicationContext`를 스프링 컨테이너라 한다.

### 스프링 컨테이너의 생성 과정
![[spring-container-1.png]]
- `new AnnotationConfigApplicationContext(AppConfig.class)` 실행 시 스프링 컨테이너가 만들어진다.
- 스프링 컨테이너 내부에는 스프링 빈(Bean) 저장소가 존재한다.
- 스프링 컨테이너 생성자에 전달한 `AppConfig.class`를 구성 정보로 활용한다.
- 스프링 빈 저장소는 맵 자료구조와 유사한 형태로 키(Key)와 값(Value)을 빈 이름, 빈 객체로 저장한다.

![[spring-container-2.png]]
- 스프링 컨테이너는 `AppConfig.class`의 구성 정보를 사용해서 `@Bean` 어노테이션이 사용된 메서드를 모두 호출한다.
- 그리고 메서드 이름을 스프링 빈 저장소에 빈 이름(Key)으로, 반환된 객체의 참조를 값(Value)으로 빈 객체에 저장한다.

> [!tip] 참고
> - 빈 이름의 기본 값은 메서드 이름을 사용한다.
> - 빈 이름은 직접 부여할 수도 있다. 
> 	- `@Bean(name="memberService2")`

![[spring-container-3.png]]
- 스프링 컨테이너는 의존관계 설정을 준비한다.
- 의존관계 설정 준비가 끝나면 설정 정보(`AppConfig.class`)를 참고해서 의존관계를 주입한다.
- 단순히 자바 코드를 호출하는 것 같지만, 차이가 있다. 스프링 컨테이너에 생성된 빈 객체는 모두 싱글턴 패턴을 사용한다는 것이다.

> [!tip] 참고
> 스프링은 빈을 생성하고, 의존관계를 주입하는 단계가 나누어져 있다. 그런데 이렇게 자바 코드로 스프링 빈을 등록하면 생성자를 호출하면서 의존관계 주입도 한번에 처리된다.
> 
> 자세한 내용은 의존관계 자동 주입에서 알아본다.



---
References: 김영한의 스프링 핵심 원리 - 기본편

Links to this page: [[스프링 핵심 원리]]